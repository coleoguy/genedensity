test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.mam,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.mam,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
View(pruned.tree)
abline(model.mam,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
# estimated genome size
library(phytools)
library(caper)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat$clade <- factor(dat$clade, levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
dat <- na.omit(dat[, c("species", "clade", "rsq", "est.gnsz.Mbp")])
map <- c("Mammalia" = "#d95f02", "Actinopterygii" = "#7570b3", "Sauria" = "#1b9e77", "Others" = "#e7298a")
cols <- map[dat$clade]
cols <- adjustcolor(cols, alpha.f = 0.5)
plot(rsq ~ est.gnsz.Mbp,
data = dat,
pch = 16,
col = cols)
tree <- read.tree("../data/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
pruned.tree <- keep.tip(tree, int)
model <- glm(rsq ~ est.gnsz.Mbp, data = dat)
res <- resid(model)
phylosig <- phylosig(pruned.tree,
setNames(res, dat$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig < 0.05) {
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
model <- pgls(rsq ~ est.gnsz.Mbp, data = cd)
}
abline(model,
lwd = 1.5)
dat.mam <- dat[dat$clade == "Mammalia", ]
model.mam <- glm(rsq ~ est.gnsz.Mbp, data = dat.mam)
res.mam <- resid(model.mam)
phylosig.mam <- phylosig(pruned.tree,
setNames(res.mam, dat.mam$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.fish,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.rep,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
# estimated genome size
library(phytools)
library(caper)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat$clade <- factor(dat$clade, levels = c("Mammalia", "Actinopterygii", "Sauria"))
dat <- na.omit(dat[, c("species", "clade", "rsq", "est.gnsz.Mbp")])
map <- c("Mammalia" = "#d95f02", "Actinopterygii" = "#7570b3", "Sauria" = "#1b9e77")
cols <- map[dat$clade]
cols <- adjustcolor(cols, alpha.f = 0.5)
plot(rsq ~ est.gnsz.Mbp,
data = dat,
pch = 16,
col = cols)
tree <- read.tree("../data/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
pruned.tree <- keep.tip(tree, int)
model <- glm(rsq ~ est.gnsz.Mbp, data = dat)
res <- resid(model)
phylosig <- phylosig(pruned.tree,
setNames(res, dat$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig < 0.05) {
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
model <- pgls(rsq ~ est.gnsz.Mbp, data = cd)
}
abline(model,
lwd = 1.5)
dat.mam <- dat[dat$clade == "Mammalia", ]
model.mam <- glm(rsq ~ est.gnsz.Mbp, data = dat.mam)
res.mam <- resid(model.mam)
phylosig.mam <- phylosig(pruned.tree,
setNames(res.mam, dat.mam$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.fish,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.rep,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
# estimated genome size
library(phytools)
library(caper)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[!duplicated(dat$species), ]
dat$clade <- factor(dat$clade, levels = c("Mammalia", "Actinopterygii", "Sauria"))
dat <- na.omit(dat[, c("species", "clade", "rsq", "est.gnsz.Mbp")])
map <- c("Mammalia" = "#d95f02", "Actinopterygii" = "#7570b3", "Sauria" = "#1b9e77")
cols <- map[dat$clade]
cols <- adjustcolor(cols, alpha.f = 0.5)
plot(rsq ~ est.gnsz.Mbp,
data = dat,
pch = 16,
col = cols)
tree <- read.tree("../data/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
pruned.tree <- keep.tip(tree, int)
model <- glm(rsq ~ est.gnsz.Mbp, data = dat)
res <- resid(model)
phylosig <- phylosig(pruned.tree,
setNames(res, dat$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig < 0.05) {
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
model <- pgls(rsq ~ est.gnsz.Mbp, data = cd)
}
abline(model,
lwd = 1.5)
dat.mam <- dat[dat$clade == "Mammalia", ]
model.mam <- glm(rsq ~ est.gnsz.Mbp, data = dat.mam)
res.mam <- resid(model.mam)
phylosig.mam <- phylosig(pruned.tree,
setNames(res.mam, dat.mam$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.fish,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.rep,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
nrow(dat[dat$clade == "Mammalia", ])
# estimated genome size
library(phytools)
library(caper)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat$clade <- factor(dat$clade, levels = c("Mammalia", "Actinopterygii", "Sauria"))
dat <- na.omit(dat[, c("species", "clade", "rsq", "est.gnsz.Mbp")])
map <- c("Mammalia" = "#d95f02", "Actinopterygii" = "#7570b3", "Sauria" = "#1b9e77")
cols <- map[dat$clade]
cols <- adjustcolor(cols, alpha.f = 0.5)
plot(rsq ~ est.gnsz.Mbp,
data = dat,
pch = 16,
col = cols)
tree <- read.tree("../data/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
pruned.tree <- keep.tip(tree, int)
model <- glm(rsq ~ est.gnsz.Mbp, data = dat)
res <- resid(model)
phylosig <- phylosig(pruned.tree,
setNames(res, dat$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig < 0.05) {
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
model <- pgls(rsq ~ est.gnsz.Mbp, data = cd)
}
abline(model,
lwd = 1.5)
dat.mam <- dat[dat$clade == "Mammalia", ]
model.mam <- glm(rsq ~ est.gnsz.Mbp, data = dat.mam)
res.mam <- resid(model.mam)
phylosig.mam <- phylosig(pruned.tree,
setNames(res.mam, dat.mam$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.fish,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.rep,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
nrow(dat[dat$clade == "Mammalia", ])
nrow(dat[dat$clade == "Actinopterygii", ])
nrow(dat[dat$clade == "Sauria", ])
nrow(dat[dat$clade == "Others", ])
# load stuff in
source("../analysis/functions.R")
packages <- c("ape", "ggplot2", "nlme")
lapply(packages, library, character.only = TRUE)
results <- read.csv("../results/vertebrates/parsed.csv")
tree <- read.tree("../data/vertebrates/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
sub <- dat[dat$species %in% c("Bos taurus", "Peromyscus maniculatus bairdii"), ]
cols <- c("#af8dc3", "#7fbf7b")[as.factor(sub$species)]
sub1 <- sub[sub$species == "Peromyscus maniculatus bairdii", ]
sub2 <- sub[sub$species == "Bos taurus", ]
model1 <- lm(genecount ~ size.Mbp, data = sub1)
res1 <- resid(model1)
summary(lm(res1 ~ sub1$size.Mbp))
plot(sub1$size.Mbp, res1)
sub2 <- sub[sub$species == "Bos taurus", ]
model2 <- lm(genecount ~ size.Mbp, data = sub2)
res2 <- resid(model2)
plot(sub2$size.Mbp, res2)
summary(lm(res2 ~ sub2$size.Mbp))
sub2 <- sub[sub$species == "Bos taurus", ]
model2 <- glm(genecount ~ size.Mbp, data = sub2)
res2 <- resid(model2)
plot(sub2$size.Mbp, res2)
summary(glm(res2 ~ sub2$size.Mbp))
sub <- sub[sub$species == "Bos taurus", ]
model <- glm(genecount ~ size.Mbp, data = sub)
res <- resid(model)
summary(glm(res ~ sub$size.Mbp))
summary(glm(res ~ sub$size.Mbp))$coefficients
summary(glm(res ~ sub$size.Mbp))$coefficients[2, 1]
summary(glm(res ~ sub$size.Mbp))$coefficients[2, 4]
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
sp <- unique(dat$species)
b <- p <- c()
for (i in sp) {
sub <- sub[sub$species == i, ]
model <- glm(genecount ~ size.Mbp, data = sub)
res <- resid(model)
b <- c(b, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 1])
p <- c(p, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 4])
}
model <- glm(genecount ~ size.Mbp, data = sub)
sub <- sub[sub$species == i, ]
i
for (i in sp) {
sub <- dat[dat$species == i, ]
model <- glm(genecount ~ size.Mbp, data = sub)
res <- resid(model)
b <- c(b, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 1])
p <- c(p, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 4])
}
df <- data.frame(sp, b, p)
View(df)
glm(res ~ sub$size.Mbp)
abs(-1)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
sp <- unique(dat$species)
b <- p <- c()
for (i in sp) {
sub <- dat[dat$species == i, ]
model <- glm(genecount ~ size.Mbp, data = sub)
res <- abs(resid(model))
b <- c(b, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 1])
p <- c(p, summary(glm(res ~ sub$size.Mbp))$coefficients[2, 4])
}
df <- data.frame(sp, b, p)
View(df)
# estimated genome size
library(phytools)
library(caper)
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat$clade <- factor(dat$clade, levels = c("Mammalia", "Actinopterygii", "Sauria"))
dat <- na.omit(dat[, c("species", "clade", "rsq", "est.gnsz.Mbp")])
map <- c("Mammalia" = "#d95f02", "Actinopterygii" = "#7570b3", "Sauria" = "#1b9e77")
cols <- map[dat$clade]
cols <- adjustcolor(cols, alpha.f = 0.5)
plot(rsq ~ est.gnsz.Mbp,
data = dat,
pch = 16,
col = cols)
tree <- read.tree("../data/formatted_tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
pruned.tree <- keep.tip(tree, int)
model <- glm(rsq ~ est.gnsz.Mbp, data = dat)
res <- resid(model)
phylosig <- phylosig(pruned.tree,
setNames(res, dat$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig < 0.05) {
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
model <- pgls(rsq ~ est.gnsz.Mbp, data = cd)
}
abline(model,
lwd = 1.5)
dat.mam <- dat[dat$clade == "Mammalia", ]
model.mam <- glm(rsq ~ est.gnsz.Mbp, data = dat.mam)
res.mam <- resid(model.mam)
phylosig.mam <- phylosig(pruned.tree,
setNames(res.mam, dat.mam$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.mam < 0.05) {
cd.mam <- comparative.data(pruned.tree, dat.mam, names.col = "species", vcv = TRUE)
model.mam <- pgls(rsq ~ est.gnsz.Mbp, data = cd.mam)
}
abline(model.mam,
col = adjustcolor("#d95f02", alpha.f = 0.5),
lwd = 1.5)
dat.fish <- dat[dat$clade == "Actinopterygii", ]
model.fish <- glm(rsq ~ est.gnsz.Mbp, data = dat.fish)
res.fish <- resid(model.fish)
phylosig.fish <- phylosig(pruned.tree,
setNames(res.fish, dat.fish$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.fish < 0.05) {
cd.fish <- comparative.data(pruned.tree, dat.fish, names.col = "species", vcv = TRUE)
model.fish <- pgls(rsq ~ est.gnsz.Mbp, data = cd.fish)
}
abline(model.fish,
col = adjustcolor("#7570b3", alpha.f = 0.5),
lwd = 1.5)
dat.rep <- dat[dat$clade == "Sauria", ]
model.rep <- glm(rsq ~ est.gnsz.Mbp, data = dat.rep)
res.rep <- resid(model.rep)
phylosig.rep <- phylosig(pruned.tree,
setNames(res.rep, dat.rep$species),
method = "lambda",
test = TRUE,
nsim = 10000)[[4]]
if (phylosig.rep < 0.05) {
cd.rep <- comparative.data(pruned.tree, dat.rep, names.col = "species", vcv = TRUE)
model.rep <- pgls(rsq ~ est.gnsz.Mbp, data = cd.rep)
}
abline(model.rep,
col = adjustcolor("#1b9e77", alpha.f = 0.5),
lwd = 1.5)
