}
}
df <- as.data.frame(do.call(rbind, lis))
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", "intercept", terms[-1], "R2")
num <- c("thrs", "intercept", terms[-1], "R2")
df[, num] <- lapply(df[, num], as.numeric)
# some stuff are lists
df[] <- lapply(df, function(x) if(is.list(x)) sapply(x, paste, collapse=",") else x)
write.csv(df, file = "../results/hyp.csv", row.names = F)
terms <- c(
"intercept",
"chromnum.1n",
"median.trans",
"rep.prop",
"chromnum.1n:median.trans",
"chromnum.1n:rep.prop",
"median.trans:rep.prop",
"chromnum.1n:median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
View(dat)
View(df)
View(df)
df1 <- df[df$stat == "p", ]
df1 <- df[df$stat == "p", ]
df1 <- df[df$median.trans < 0.05, ]
df1 <- df[df$rep.prop < 0.05, ]
df1 <- df[df$median.trans.rep.prop < 0.05, ]
View(df1)
dat <- read.csv("../results/parsed.csv")
View(dat)
dat <- dat[dat$thrs == 0, ]
View(dat)
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
i <- unique(dat$species)[1]
paste(terms, ".rep.pct")
paste0(terms, ".rep.pct")
unique(dat[dat$species == i, ][[paste0(terms, ".rep.pct")]])
dat[dat$species == i, ][[paste0(terms, ".rep.pct")]]
View(dat[dat$species == i, ])
sub <- dat[dat$species == i, ]
sub[, paste0(terms, ".rep.pct")]
sub <- dat[dat$species == i, ][, paste0(terms, ".rep.pct")]
sub
sub <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
sub
max(unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")]))
sort(unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")]))
unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
rep[which.max(rep)]
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
rep[which.max(rep)]
names(rep[which.max(rep)])
strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1]
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1]
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
result <- strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1]
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
result <- c()
for (i in unique(dat$species)) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
result <- c(result, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
rep
is.na(rep)
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
result <- c()
for (i in unique(dat$species)) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
if (any(is.na(rep)) == TRUE) {
result <- c(result, NA)
} else {
result <- c(result, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
}
result
species <- (unique(dat$species))
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
species <- unique(dat$species)
unique(dat$rsq)
rsq <- unique(dat$rsq)
rsq <- unique(setNames(dat$rsq, dat$species))
rsq
rsq <- setNames(dat$rsq, dat$species)
rsq
rsq <- unique(setNames(dat$rsq, dat$species))
rsq
rsq <- setNames(dat$rsq, dat$species) |> unique()
rsq
rsq <- setNames(dat$rsq, dat$species)
rsq
unique(rsq)
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
species <- unique(dat$species)
rsq <- dat$rsq
largest <- c()
for (i in species) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
if (any(is.na(rep)) == TRUE) {
largest <- c(largest, NA)
} else {
largest <- c(largest, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
}
df <- data.frame(species, rsq, largest)
df <- unique(dat[, c("species", "clade", "rsq")])
View(df)
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
df <- unique(dat[, c("species", "clade", "rsq")])
largest <- c()
for (i in df$species) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
if (any(is.na(rep)) == TRUE) {
largest <- c(largest, NA)
} else {
largest <- c(largest, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
}
df$largest <- largest
View(df)
df <- na.omit(df)
View(df)
library(beeswarm)
beeswarm(largest ~ rsq, data = df)
beeswarm(rsq ~ largest, data = df)
library(viridis)
viridis(3)
beeswarm(rsq ~ largest, data = df, pwcol = as.numeric(factor(df$clade)))
viridis(4)
cols <- viridis(4)
beeswarm(rsq ~ largest, data = df, pwcol = cols)
num_groups <- length(unique(dat$clade))
color_palette <- viridis(length(unique(dat$clade)))
cols <- viridis(length(unique(dat$clade)))
cols
cols[as.numeric(factor(df$clade))]
cols <- viridis(length(unique(dat$clade)))[as.numeric(factor(df$clade))]
cols
beeswarm(rsq ~ largest, data = df, pwcol = cols)
factor(df$clade)
cols <- c("red", "blue", "green", "purple")
levels <- as.factor(df$clade, levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
levels
levels[cols]
cols[levels]
beeswarm(rsq ~ largest, data = df, pwcol = cols[levels])
cols <- viridis(4)
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
beeswarm(rsq ~ largest, data = df, pwcol = cols[levels])
cols <- c("red", "blue", "green", "purple")
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
beeswarm(rsq ~ largest, data = df, pwcol = cols[levels])
beeswarm(rsq ~ largest, data = df, pch = 16, pwcol = cols[levels])
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
df <- unique(dat[, c("species", "clade", "rsq")])
largest <- c()
for (i in df$species) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
if (any(is.na(rep)) == TRUE) {
largest <- c(largest, NA)
} else {
largest <- c(largest, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
}
df$largest <- largest
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
beeswarm(rsq ~ largest, data = df, pch = 16, pwcol = cols[levels])
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(0, 0, "stuff")
text(50, 50, "stuff")
text(0.5, 0.5, "stuff")
text(0.5, 0.6, "stuff")
text(0.6, 0.6, "stuff")
text(0.6, 0.9, "stuff")
text(0.6, 1.1, "stuff")
text(5, -1, "Text below plot", xpd = NA)
text(0.5, 1, "stuff", xpd = NA)
text(0.5, 1.1, "stuff", xpd = NA)
par(mar = c(5, 4, 4, 6))
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
par(mar = c((5, 4, 4, 6)+0.1))
par(mar = c(5, 4, 4, 6)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(0.5, 1.1, "Mammalia", xpd = NA)
text(2, 1.1, "Mammalia", xpd = NA)
text(5, 1.1, "Mammalia", xpd = NA)
text(5.6, 1.1, "Mammalia", xpd = NA)
text(5.6, 0.5, "Mammalia", xpd = NA)
text(5.6, 0.7, "Mammalia", xpd = NA)
text(5.6, 0.8, "Mammalia", xpd = NA)
text(5.6, 0.75, "Mammalia", xpd = NA)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5.6, 0.75, "Mammalia", xpd = NA)
text(5.6, 0.8, "Mammalia", xpd = NA)
text(5.6, 0.4, "Mammalia", xpd = NA)
text(5.6, 0.35, "Mammalia", xpd = NA)
text(5.6, 0.3, "Mammalia", xpd = NA)
text(5.6, 0.25, "Mammalia", xpd = NA)
(8-0.25)/4
(8-0.25)/3
((8-0.25)/3)
(2*(8-0.25)/3)
((8-0.25))
text(5.6, 0.25+((8-0.25)), "Mammalia", xpd = NA)
text(5.6, 0.25+(2*(8-0.25)/3), "Mammalia", xpd = NA)
text(5.6, 0.25+((8-0.25)/3), "Mammalia", xpd = NA)
text(5.6, 0.25, "Mammalia", xpd = NA)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5.6, 0.25+((8-0.25)), "Mammalia", xpd = NA)
text(5.6, 0.25+(2*(8-0.25)/3), "Mammalia", xpd = NA)
text(5.6, 0.25+((8-0.25)/3), "Mammalia", xpd = NA)
text(5.6, 0.25, "Mammalia", xpd = NA)
text(5.6, (0.25+((8-0.25))), "Mammalia", xpd = NA)
(0.25+((8-0.25)))
(0.25+(2*(8-0.25)/3))
(0.25+((8-0.25)/3))
0.25
(0.25+((8-0.25)))
(0.25+(2*(8-0.25)/3))
(0.25+((8-0.25)/3))
text(5.6, 8, "Mammalia", xpd = NA)
text(5.6, 5.416667, "Mammalia", xpd = NA)
text(5.6, 2.833333, "Mammalia", xpd = NA)
text(5.6, 0.25, "Mammalia", xpd = NA)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5.6, 8, "Mammalia", xpd = NA)
text(5.6, 0.8, "Mammalia", xpd = NA)
text(5.6, (0.25+((0.8-0.25))), "Mammalia", xpd = NA)
text(5.6, (0.25+(2*(0.8-0.25)/3)), "Mammalia", xpd = NA)
text(5.6, (0.25+((0.8-0.25)/3)), "Mammalia", xpd = NA)
text(5.6, 0.25, "Mammalia", xpd = NA)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5.5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA)
text(5.5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA)
text(5.5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA)
text(5.5, 0.25, "Others", xpd = NA)
text(5.5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5.5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5.5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5.5, 0.25, "Others", xpd = NA, adj = 0)
par(mar = c(5.1, 4.1, 4.1, 2.1))
text(5.4, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5.4, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5.2, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5.1, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5.1, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5.1, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5.1, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5.1, 0.25, "Others", xpd = NA, adj = 0)
points(5.1, (0.25+((0.8-0.25))), pch = 16, color = "red", xpd = NA)
points(5.0, (0.25+((0.8-0.25))), pch = 16, color = "red", xpd = NA)
points(5.0, (0.25+((0.8-0.25))), pch = 16, col = "red", xpd = NA)
points(5.0, (0.25+((0.8-0.25))), pch = 16, col = "red", xpd = NA)
points(5.0, (0.25+(2*(0.8-0.25)/3)), pch = 16, col = "blue", xpd = NA)
points(5.0, (0.25+((0.8-0.25)/3)), pch = 16, col = "green", xpd = NA)
points(5.0, 0.25, pch = 16, col = "purple", xpd = NA)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5, 0.25, "Others", xpd = NA, adj = 0)
points(4.9, (0.25+((0.8-0.25))), pch = 16, col = "red", xpd = NA)
points(4.9, (0.25+(2*(0.8-0.25)/3)), pch = 16, col = "blue", xpd = NA)
points(4.9, (0.25+((0.8-0.25)/3)), pch = 16, col = "green", xpd = NA)
points(4.9, 0.25, pch = 16, col = "purple", xpd = NA)
par(mar = c(5.1, 4.1, 4.1, 2.1))
viridis(4)
library(beeswarm)
cols <- c("red", "blue", "green", "purple")
levels <- factor(as.factor(df$clade), levels = c("Mammalia", "Actinopterygii", "Sauria", "Others"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5, 0.25, "Others", xpd = NA, adj = 0)
viridis(5)
viridis(4)
terms <- c("line", "sine", "ltr", "dna", "rc")
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
df <- unique(dat[, c("species", "clade", "rsq")])
largest <- c()
for (i in df$species) {
rep <- unique(dat[dat$species == i, ][, paste0(terms, ".rep.pct")])
if (any(is.na(rep)) == TRUE) {
largest <- c(largest, NA)
} else {
largest <- c(largest, strsplit(names(rep[which.max(rep)]), "\\.")[[1]][1])
}
}
df$largest <- largest
library(beeswarm)
cols <- viridis(4)
levels <- factor(as.factor(df$clade), levels = c("Others", "Sauria", "Actinopterygii", "Mammalia"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5, 0.25, "Others", xpd = NA, adj = 0)
points(4.9, (0.25+((0.8-0.25))), pch = 16, col = "#FDE725FF", xpd = NA)
points(4.9, (0.25+(2*(0.8-0.25)/3)), pch = 16, col = "#31688EFF", xpd = NA)
points(4.9, (0.25+((0.8-0.25)/3)), pch = 16, col = "#35B779FF", xpd = NA)
points(4.9, 0.25, pch = 16, col = "#440154FF", xpd = NA)
par(mar = c(5.1, 4.1, 4.1, 2.1))
points(4.9, (0.25+((0.8-0.25))), pch = 16, col = "#440154FF", xpd = NA)
viridis(4)
viridis(4)
points(4.9, (0.25+((0.8-0.25))), pch = 16, col = "#FDE725FF", xpd = NA)
library(beeswarm)
cols <- viridis(4)
levels <- factor(as.factor(df$clade), levels = c("Others", "Actinopterygii", "Sauria", "Mammalia"))
par(mar = c(5, 4, 4, 7)+0.1)
beeswarm(rsq ~ largest,
data = df,
xlab = "largest repeat class",
ylab = "R2",
pch = 16,
pwcol = cols[levels])
text(5, (0.25+((0.8-0.25))), "Mammalia", xpd = NA, adj = 0)
text(5, (0.25+(2*(0.8-0.25)/3)), "Actinopterygii", xpd = NA, adj = 0)
text(5, (0.25+((0.8-0.25)/3)), "Sauria", xpd = NA, adj = 0)
text(5, 0.25, "Others", xpd = NA, adj = 0)
points(4.9, (0.25+((0.8-0.25))), pch = 16, col = "#FDE725FF", xpd = NA)
points(4.9, (0.25+(2*(0.8-0.25)/3)), pch = 16, col = "#31688EFF", xpd = NA)
points(4.9, (0.25+((0.8-0.25)/3)), pch = 16, col = "#35B779FF", xpd = NA)
points(4.9, 0.25, pch = 16, col = "#440154FF", xpd = NA)
par(mar = c(5.1, 4.1, 4.1, 2.1))
viridis(4)
View(df)
terms <- c(
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
View(df)
terms <- c(
"intercept"
"median.trans",
df <- read.csv("../results/hyp.csv")
terms <- c(
"intercept",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
View(df)
# models where every term is either significant or NA
df1 <- df[apply(df[, terms[-1]], 1, function(x) all(is.na(x) | x < 0.05)), ]
terms <- c(
"intercept",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
# models where every term is either significant or NA
df1 <- df[apply(df[, terms[-1]], 1, function(x) all(is.na(x) | x < 0.05)), ]
# remove models with all NA terms
df1 <- df1[rowSums(is.na(df1[, terms[-1]])) < length(terms[-1]), ]
# filter for significant clade-threshold-repeat combinations
df1 <- df1[df1$stat == "p", ]
hit <- c("clade", "thrs", "repeat")
df1 <- df1[, hit]
# get beta coefficients for significant combinations
df2 <- merge(df, df1, by = intersect(names(df), names(df1)))
df2 <- df2[df2$stat == "beta", ]
View(df2)
terms <- c(
"intercept",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
# models where every term is either significant or NA
df1 <- df[apply(df[, terms[-1]], 1, function(x) all(is.na(x) | x < 0.05)), ]
View(df1)
terms <- c(
"intercept",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
terms <- c(
"(Intercept)",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
df <- read.csv("../results/hyp.csv")
names(df) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "R2")
# models where every term is either significant or NA
df1 <- df[apply(df[, terms[-1]], 1, function(x) all(is.na(x) | x < 0.05)), ]
View(df1)
View(df)
