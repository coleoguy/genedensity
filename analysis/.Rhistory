repstats <- rbind(repstats, df)
}
View(repstats)
# reorganize and save results
dat <- merge(dat, repstats, by= "species", all = T)
dat <- dat[order(dat$size.Mb, decreasing = TRUE), ]
dat <- dat[order(dat$species), ]
dat <- dat[order(dat$thrs), ]
write.csv(dat,
"../results/parsed.csv",
row.names = FALSE)
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
model <- dredge(glm(dat$rsq ~ age.norm*prop.norm, na.action = na.fail), subset = dc(x1, x2, x1:x2))
models <- rbind(models, model)
}
models$model <- rep(combs, each = 5)
View(models)
View(model)
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
models <- data.frame()
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = true)
library(caper)
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = true)
cd <- comparative.data(pruned.tree, dat, names.col = "species", vcv = TRUE)
models <- data.frame()
i <- combs
i <- combs[12]
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
sub <- dat[, c("species", "clade")]
View(sub)
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
View(sub)
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = sub, na.action = na.fail), subset = dc(x1, x2, x1:x2))
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = sub), subset = dc(x1, x2, x1:x2))
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
View(model)
library(MuMIn)
library(phytools)
library(caper)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
models <- rbind(models, model)
}
models$model <- rep(combs, each = 5)
View(models)
plot(models$AICc)
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Total", ]
# fit GLS models
gls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
model <- dredge(glm(dat$rsq ~ age.norm*prop.norm, na.action = na.fail), subset = dc(x1, x2, x1:x2))
gls.models <- rbind(models, model)
}
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
# fit GLS models
gls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
model <- dredge(glm(dat$rsq ~ age.norm*prop.norm, na.action = na.fail), subset = dc(x1, x2, x1:x2))
gls.models <- rbind(models, model)
}
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
# fit GLS models
gls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
model <- dredge(glm(dat$rsq ~ age.norm*prop.norm, na.action = na.fail), subset = dc(x1, x2, x1:x2))
gls.models <- rbind(gls.models, model)
}
gls.models$model <- rep(combs, each = 5)
library(MuMIn)
library(phytools)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
# fit GLS models
gls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
age.norm <- (age - range(age)[1]) / diff(range(age))
prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
model <- dredge(glm(dat$rsq ~ age.norm*prop.norm, na.action = na.fail), subset = dc(x1, x2, x1:x2))
gls.models <- rbind(gls.models, model)
}
gls.models$model <- rep(combs, each = 5)
View(gls.models)
plot(gls.models)
plot(gls.models$AICc)
plot(gls.models$AICc,
xlab = "idx",
ylab = "AICc",
main = "AICcs for Mammal PGLS"
)
plot(gls.models$AICc,
xlab = "idx",
ylab = "AICc",
main = "Mammal PGLS AICcs"
)
library(MuMIn)
library(phytools)
library(caper)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Total", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
library(MuMIn)
library(phytools)
library(caper)
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
# dat <- dat[dat$clade == "Mammalia", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
pgls.models$model <- rep(combs, each = 5)
View(model)
View(pgls.models)
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
# dat <- dat[dat$clade == "Mammalia", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
# record model terms
pgls.models$model <- rep(combs, each = 5)
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
# record model terms
pgls.models$model <- rep(combs, each = 5)
?write.csv
write.csv(pgls.models, "../results/aic.csv", row.names = FALSE)
write.csv(as.data.frame(pgls.models), "../results/aic.csv", row.names = FALSE)
pgls.models <- read.csv("../results/aic.csv")
View(pgls.models)
pgls.models <- read.csv("../results/aic.csv")
View(pgls.models)
plot(pgls.models$AICc)
View(pgls.models)
View(pgls.models)
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Actionopteryrgii", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Actionopteryrgii", ]
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Actinopterygii", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
# record model terms
pgls.models$model <- rep(combs, each = 5)
View(pgls.models)
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Sauria", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
# record model terms
pgls.models$model <- rep(combs, each = 5)
View(pgls.models)
library(MuMIn)
library(phytools)
library(caper)
# identify repeats of interest
terms <- c("dna", "line", "ltr", "sine", "others", "unknown")
combs <- unlist(lapply(1:length(terms), function(x) {
apply(combn(terms, x), 2, paste, collapse = ".")
}))
dat <- read.csv("../results/parsed.csv")
dat <- dat[!is.na(dat$chromnum.1n) & !duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "clade", "rsq", "rep.prop.total", paste0("rep.prop.", terms), "rep.age.total", paste0("rep.age.", combs))])
dat <- dat[dat$clade == "Mammalia", ]
# prune tree
tree <- read.tree("../data/formatted.tree.nwk")
tree$tip.label <- gsub("_", " ", tree$tip.label)
int <- intersect(dat$species, tree$tip.label)
dat <- dat[dat$species %in% int, ]
pruned.tree <- keep.tip(tree, int)
# fit PGLS models
pgls.models <- data.frame()
for (i in combs) {
# get repeat age and proportion
rep <- unlist(strsplit(i, "\\."))
prop <- as.numeric(rowSums(as.data.frame(dat[, c(paste0("rep.prop.", rep))])))
age <- dat[, c(paste0("rep.age.", i))]
# create new dataframe to make cd object for PGLS; normalize data
sub <- dat[, c("species", "clade", "rsq")]
sub$age.norm <- (age - range(age)[1]) / diff(range(age))
sub$prop.norm <- (prop - range(prop)[1]) / diff(range(prop))
# fit model
cd <- comparative.data(pruned.tree, sub, names.col = "species", vcv = TRUE)
model <- dredge(pgls(rsq ~ age.norm*prop.norm, data = cd), subset = dc(x1, x2, x1:x2))
pgls.models <- rbind(pgls.models, model)
}
# record model terms
pgls.models$model <- rep(combs, each = 5)
write.csv(as.data.frame(pgls.models), "../results/mammal.aic.csv", row.names = FALSE)
pgls.models <- read.csv("../results/mammal.aic.csv")
View(pgls.models)
