xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3.1),
xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Podarcis muralis", ]
meerkat <- dat[dat$species == "Aquila chrysaetos chrysaetos", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3.1),
xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3.1),
xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3.1),
xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3.1),
xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
View(l)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
# ylim = c(0.2, 3.1),
# xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
# ylim = c(0.2, 3.1),
# xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0, 3),
# xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0, 3),
# xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3),
# xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 3),
# xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.8),
# xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.8),
# xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.7),
# xlim = c(0, 200),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.7),
# xlim = c(0, 200),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.2, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.15, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.15, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 130),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 125),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.7),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
# rsq scatter
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0.8, ]
dat <- dat[dat$clade %in% c("Mammalia", "Sauria", "Actinopterygii"), ]
dat <- dat[!is.na(dat$chromnum.1n), ]
dat$genecount <- dat$genecount / 1000
horse <- dat[dat$species == "Gallus gallus", ]
meerkat <- dat[dat$species == "Podarcis muralis", ]
par(mfrow = c(1, 2))
par(mar = c(5.1, 4.1, 4.1, 0.9))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(horse$size.Mb,
horse$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.8),
xlim = c(0, 125),
xlab = NA,
ylab = "Gene count (thousands)")
abline(glm(genecount ~ size.Mb, data = horse), lwd = 1.5, col = color)
par(mar = c(5.1, 2.9, 4.1, 2.1))
color <- adjustcolor("#405070", alpha.f = 0.7)
plot(meerkat$size.Mb,
meerkat$genecount,
pch = 16,
cex = 0.8,
col = color,
ylim = c(0.25, 2.8),
xlim = c(0, 150),
xlab = NA,
ylab = NA)
abline(glm(genecount ~ size.Mb, data = meerkat), lwd = 1.5, col = color)
View(l)
View(l)
View(l)
View(l)
terms <- c(
"intercept",
"median.trans",
"rep.prop",
"median.trans:rep.prop"
)
dat <- read.csv("../results/models1.csv")
names(dat) <- c("clade", "thrs", "repeat", "phylosig", "n", "stat", terms, "f2")
# models where every term is either significant or NA
df <- dat[apply(dat[, terms[-1]], 1, function(x) all(is.na(x) | x < 0.05)), ]
# remove models with all NA terms
df <- df[rowSums(is.na(df[, terms[-1]])) < length(terms[-1]), ]
# filter for significant clade-threshold-repeat combinations
df <- df[df$stat == "p", ]
hit <- c("clade", "thrs", "repeat")
df <- df[, hit]
# get beta coefficients for significant combinations
df <- merge(dat, df, by = intersect(names(dat), names(df)))
df <- df[df$stat == "beta", ]
df <- df[!df$`repeat` %in% "rc", ]
df <- df[order(df$thrs), ]
df <- df[order(df$`repeat`), ]
df <- df[order(df$clade), ]
rownames(df) <- c(1:nrow(df))
df <- df[df$thrs >= 0.8, ]
#combinations of clades and repeats
comb <- unique(df[, c("clade", "repeat"), ])
beta <- c()
for (i in 1:nrow(comb)) {
cl <- comb[i, ][[1]]
rep <- comb[i, ][[2]]
sub <- df[df$clade == cl, ]
sub <- sub[sub$`repeat` == rep, ]
sub <- sub[, terms[-1]]
to.keep <- c()
for (j in 1:nrow(sub)) {
if (sum(is.na(sub[j, terms[-1]])) == length(terms[-1])-1) {
to.keep <- c(to.keep, j)
}
}
sub <- sub[to.keep, ]
if (nrow(sub) == 0) {
beta <- c(beta, NA)
next
}
sub <- sub[, terms[-c(1, 4)]]
beta <- c(beta, median(as.matrix(sub)[which(!is.na(sub))]))
}
comb$beta <- beta
comb$abs <- abs(beta)
comb <- na.omit(comb)
# define tick marks
n <- 5
seq(from = 0, to = max(comb$abs), length.out = 5)
View(comb)
View(df)
# color mapping
library(viridis)
res <- 1000
palette <- viridis(res)
comb$cols <- palette[round((comb$abs / (max(comb$abs))) * (res-1)) + 1]
View(comb)
