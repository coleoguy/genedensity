geom_point(shape = 16, alpha = 0.4, size = 2.3) +
ggtitle(bquote("Gene Count Vs Contig Size"))+
theme(plot.title = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
legend.title = element_blank(),
legend.background = element_rect(fill = "#f2f2f2", color = "black", linewidth = 0.5),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25),
legend.position = c(0.86, 0.69),
legend.key.size = unit(21, "points"))+
xlim(c(0, 6.8)) +
ylim(c(0.09, 1.02))+
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(x = "Contig Size (Gbp)", y = "Gene Count")
ggsave(filename = paste0(species, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
species
i
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == species]
contigSize <- dat$contigSize.bp[dat$species == species]
geneCountVsContigSize <- data.table(geneCount, contigSize)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
ggtitle("Gene Count Vs Contig Size") +
theme(plot.title = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(x = "Contig Size", y = "Gene Count")
ggsave(filename = paste0(species, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
warning()
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == species]
contigSize <- dat$contigSize.bp[dat$species == species]
geneCountVsContigSize <- data.table(geneCount, contigSize)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
ggtitle(paste0("Gene Count Vs Contig Size for ", i)) +
theme(plot.title = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(x = "Contig Size", y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
ggtitle(paste0("Gene Count Vs Contig Size for ", i)) +
theme(plot.title = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(x = "Contig Size", y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
i
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
fit
fit$coefficients[1, 2]
fit$coefficients
fit$coefficients[1]
fit$coefficients[1, 1]
fit$coefficients[2, 1]
slope <- fit$coefficients[2, 1]
intercept <- fit$coefficients[1, 1]
fit$coefficients[2, 4]
fit
fit$adj.r.squared
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- fit$coefficients[2, 1]
intercept <- fit$coefficients[1, 1]
rsq <- fit$adj.r.squared
bquote(y=.(slope)x+.(intercept)","~italic(r)^2=.(rsq))
slope
bquote(.(slope))
bquote(y=.(slope)x)
bquote(y=.(slope))
bquote(y=.(slope))
slope
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- fit$coefficients[2, 1]
intercept <- fit$coefficients[1, 1]
rsq <- fit$adj.r.squared
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = paste0("Gene Count Vs Contig Size for ", i),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = paste0("Gene Count Vs Contig Size for ", i),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = paste0("Gene Count vs Contig Size for ", bquote(italic(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = paste0("Gene Count vs Contig Size for ", bquote(italic(.(i)))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
bquote(italic(.(i))
)
i
bquote(italic(.(i)))
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = bquote("Gene Count vs Contig Size for"~italic(.(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
combinedResultsCsvPath <- "../../results/vertebrates/combinedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(combinedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = bquote("Gene Count vs Contig Size for"~italic(.(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
View(dat)
sum(dat$contigGeneCount[contig$species == "Rhinopithecus bieti"])
sum(dat$contigGeneCount[dat$species == "Rhinopithecus bieti"])
View(dat)
sum(dat$contigGeneCount[dat$species == "Poecilia mexicana"])
sum(dat$contigGeneCount[dat$species == "Castor canadensis"])
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
parsedResultsCsvPath <- "../../results/vertebrates/parsedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(parsedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = bquote("Gene Count vs Contig Size for"~italic(.(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
parsedResultsCsvPath <- "../../results/vertebrates/parsedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(parsedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = bquote("Gene Count vs Contig Size for"~italic(.(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
# constants
requiredPackages <- c("data.table", "ggplot2")
# paths
functionsPath <- "../../analysis/functions.R"
parsedResultsCsvPath <- "../../results/vertebrates/parsedResults.csv"
# load stuff in
source(functionsPath)
loadPackages(requiredPackages)
dat <- fread(parsedResultsCsvPath)
species <- unique(dat$species)
for (i in species) {
geneCount <- dat$contigGeneCount[dat$species == i]
contigSize <- dat$contigSize.bp[dat$species == i]
geneCountVsContigSize <- data.table(geneCount, contigSize)
fit <- summary(lm(geneCount ~ contigSize))
slope <- signif(fit$coefficients[2, 1], 3)
intercept <- signif(fit$coefficients[1, 1], 3)
rsq <- signif(fit$adj.r.squared, 3)
ggplot(geneCountVsContigSize, aes(x = contigSize, y = geneCount)) +
geom_point(shape = 16, alpha = 0.4, size = 2.3) +
theme(plot.title = element_text(hjust = 0.475),
plot.subtitle = element_text(hjust = 0.475),
axis.line = element_line(color = "black"),
panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(color = "black", linetype = "dotted", size = 0.25)) +
geom_smooth(method = "lm", se = FALSE, color = "black", linetype = "dashed", linewidth = 0.5, fullrange = TRUE)+
labs(
title = bquote("Gene Count vs Contig Size for"~italic(.(i))),
subtitle = bquote(y == .(slope) * x + .(intercept) * "," ~~ italic(r)^2 == .(rsq)),
x = "Contig Size",
y = "Gene Count")
ggsave(filename = paste0(i, ".jpg"),
path = "vertebrates",
plot = last_plot(),
width = 7680,
height = 4320,
units = "px",
dpi = 1100)
}
