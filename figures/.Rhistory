assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylim = c(0, 1.1*max(colSums(divsum))),
ylab = NA)
axis(1)
pos <- seq(0.15 * max(colSums(divsum)), 0.9 * max(colSums(divsum)), length.out = 6)
text(58, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(58, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(58, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(58, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(58, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(58, pos[1], "Unknown", xpd = NA, adj = c(0, 0.5))
points(55, pos[6], pch = 16, col = cols[6], xpd = NA, cex = 1.5)
points(55, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(55, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)}
points(55, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(55, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(55, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(55, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(55, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(55, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylim = c(0, 1.1*max(colSums(divsum))),
ylab = NA)
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
par(mar = c(3, 4, 1, 7)+0.1)
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylim = c(0, 1.1*max(colSums(divsum))),
ylab = NA)
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = "Kimura 2-Parameter Divergence",
ylab = "Percent of Genome",
ylim = c(0, 1.1*max(colSums(divsum))))
par(mar = c(4, 4, 1, 7)+0.1)
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = "Kimura 2-Parameter Divergence",
ylab = "Percent of Genome",
ylim = c(0, 1.1*max(colSums(divsum))))
sp
i <- 138
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*max(colSums(divsum))))
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
sp
i <- 19
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*max(colSums(divsum))))
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
1.1*max(colSums(divsum)))
1.1*max(colSums(divsum))
max(colSums(divsum))
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "rsq", "clade", "asmblysize.Mbp")])
files <- list.files("../results/divsums")
sp <- gsub("_", " ", gsub(".divsum$", "", files))
asmbsz <- dat[dat$species %in% sp, ]
asmbsz <- setNames(asmbsz$asmblysize.Mbp*1000000, asmbsz$species)
cols <- c("#e31a1c", "#fb9a99", "#33a02c", "#b2df8a", "#1f78b4", "#a6cee3")
par(mar = c(3, 4, 1, 7)+0.1)
i <- 19
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*max(colSums(divsum))))
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
i <- 138
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*3.049599))
axis(1)
pos <- seq(0.2 * 3.049599, 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*3.049599))
axis(1)
pos <- seq(0.2 * 3.049599, 0.85 * 3.049599, length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
par(mar = c(3, 4, 1, 7)+0.1)
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*3.049599))
axis(1)
pos <- seq(0.2 * 3.049599, 0.85 * 3.049599, length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
par(mar = c(5.1, 4.1, 4.1, 2.1))
dat <- read.csv("../results/parsed.csv")
dat <- dat[dat$thrs == 0, ]
dat <- dat[!duplicated(dat$species), ]
dat <- na.omit(dat[, c("species", "rsq", "clade", "asmblysize.Mbp")])
files <- list.files("../results/divsums")
sp <- gsub("_", " ", gsub(".divsum$", "", files))
asmbsz <- dat[dat$species %in% sp, ]
asmbsz <- setNames(asmbsz$asmblysize.Mbp*1000000, asmbsz$species)
cols <- c("#e31a1c", "#fb9a99", "#33a02c", "#b2df8a", "#1f78b4", "#a6cee3")
par(mar = c(3, 4, 1, 7)+0.1)
i <- 19
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*max(colSums(divsum))))
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
i <- 138
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*max(colSums(divsum))))
axis(1)
pos <- seq(0.2 * max(colSums(divsum)), 0.85 * max(colSums(divsum)), length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
species <- sp[i]
# read text file into lines
divsum <- readLines(paste0("../results/divsums/", files[i]))
# look for the start of relevant information
phrase <- "Coverage for each repeat class and divergence (Kimura)"
start.index <- match(phrase, divsum) + 1
# condense relevant lines into a table
divsum <- divsum[start.index:length(divsum)]
divsum <- read.table(textConnection(divsum),
sep = " ",
header = TRUE)
# drop columns with all NA
divsum <- divsum[-c(which(sapply(divsum, function(col) all(is.na(col)))))]
# condense table
classes <- c("LINE", "SINE", "LTR", "DNA", "Div", "Unknown")
for (j in classes) {
pat <- paste0("^", j, "(\\.|$)")
headers <- grep(pat, names(divsum), value = TRUE)
sub <- divsum[, headers]
sums <- rowSums(as.matrix(sub)) / asmbsz[i] * 100
divsum <- divsum[, !names(divsum) %in% headers]
assign(j, sums)
}
Others <- rowSums(as.matrix(divsum)) / asmbsz[i] * 100
divsum <- data.frame(LINE, SINE, LTR, DNA, Others, Unknown)
divsum <- t(as.matrix(divsum))
divsum <- divsum[, 1:51]
divsum <- divsum[nrow(divsum):1, ]
barplot(divsum,
col = cols, # Assign different colors to each group
space = 0,                       # No space between bars for a continuous look
border = NA,                     # Remove borders for cleaner appearance
xlab = NA,
ylab = NA,
ylim = c(0, 1.1*3.049599))
axis(1)
pos <- seq(0.2 * 3.049599, 0.85 * 3.049599, length.out = 6)
text(55, pos[6], "LINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[5], "SINE", xpd = NA, adj = c(0, 0.5))
text(55, pos[4], "LTR", xpd = NA, adj = c(0, 0.5))
text(55, pos[3], "DNA", xpd = NA, adj = c(0, 0.5))
text(55, pos[2], "Others", xpd = NA, adj = c(0, 0.5))
text(55, pos[1], "Unclassified", xpd = NA, adj = c(0, 0.5))
points(53, pos[6], pch = 15, col = cols[6], xpd = NA, cex = 1.5)
points(53, pos[5], pch = 15, col = cols[5], xpd = NA, cex = 1.5)
points(53, pos[4], pch = 15, col = cols[4], xpd = NA, cex = 1.5)
points(53, pos[3], pch = 15, col = cols[3], xpd = NA, cex = 1.5)
points(53, pos[2], pch = 15, col = cols[2], xpd = NA, cex = 1.5)
points(53, pos[1], pch = 15, col = cols[1], xpd = NA, cex = 1.5)
