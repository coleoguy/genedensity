dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = names(num.sp),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = names(num.sp),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = names(num.sp),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = c("Mammals", "Ray-finned fish", "Reptiles"),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = c("Mammals", "Ray-finned fish", "Reptiles"),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.5,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = c("Mammals", "Ray-finned fish", "Reptiles"),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.3,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = c("Mammals", "Ray-finned fish", "Reptiles"),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.3,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.2,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 0.9, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
# no pics
library(beeswarm)
dat <- read.csv("../results/rsq.csv")
clades <- c("Mammalia", "Actinopterygii", "Sauropsida")
dat <- dat[dat$clade %in% clades, ]
dat$clade <- factor(dat$clade, levels = clades)
map <- setNames(c("#d95f02", "#7570b3", "#1b9e77"), clades)
cols <- map[dat$clade]
num.sp <- sapply(clades, function(cl) {
nrow(dat[dat$clade == cl, ])})
# plot
beeswarm(rsq ~ clade,
xlab = NA,
ylab = NA,
data = dat,
pwcol = cols,
pch = 16,
spacing = 1.4,
xaxt = "n", yaxt = "n")
# xaxt
axis(side   = 1,
at     = seq(num.sp),
labels = c("Mammals", "Ray-finned fish", "Reptiles"),
mgp = c(3, 0.9, 0))
axis(side   = 1,
at     = seq(num.sp),
labels = paste0("n=", num.sp),
mgp = c(3, 2.1, 0))
# yaxt
axis(side = 2, mgp = c(3, 0.9, 0))
mtext(expression(R^2), side = 2, line = 2.4)
dat <- read.csv("../results/major-assem.csv")
dat$date <- as.Date(dat$date, format = "%d-%b-%Y")
for (i in unique(dat$sp)) {
da <- dat[dat$sp == i, ]
y <- da$lowercase / da$assembly_size
plot(da$date, y,
xlab = "date", ylab = "y",
main = gsub("_", " ", i))
readline("Press [Enter] to continue...")
}
dat <- dat[dat$sp == "Mus_musculus", ]
dat <- dat[dat$assem != "GRCm39", ]
y <- dat$lowercase / dat$assembly_size
plot(dat$date, y,
pch = 16, cex = 1,
xlim = c(11300, 15600),
ylim = c(0.25, 0.47),
xlab = "Release date", ylab = "Prop. of masked nucleotides",
main = "Mus musculus")
fit <- glm(y ~ date, data = dat)
abline(fit, lwd = 1.5)
species <- read.csv("../data/chrom-and-gsz.csv")
landscape <- read.csv("../results/repeat-results.csv")
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
View(r2)
View(landscape)
?merge()
tab <- merge(species, r2, by = "species")
tab <- merge(species, r2, by = "species", all = T)
View(tab)
tab <- merge(tab, landscape, by = "species", all = T)
View(tab)
View(landscape)
View(landscape)
landscape$species
match(landscape$species, species$species)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species[match(landscape$species, species$species), ]$new <- "h"
View(species)
match(landscape$species, species$species),
match(landscape$species, species$species)
species$new <- NA
species$new[match(landscape$species, species$species)] <- "H"
View(species)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
View(species)
which(is.na(species$has.landscape))
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
View(r2)
View(r2)
View(species)
View(r2)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
species <- merge(species, r2, by = "species", all = T)
View(species)
View(species)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
species <- merge(species, r2, by = "species", all = T)
View(species)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
species <- merge(species, r2, by = "species", all = T)
species <- species[, c("species", "clade", "rsq", "assmb.sz", "has.landscape")]
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
species <- merge(species, r2, by = "species", all = T)
View(species)
species <- read.csv("../data/chrom-and-gsz.csv")
r2 <- read.csv("../results/rsq.csv")
landscape <- read.csv("../results/repeat-results.csv")
species$has.landscape <- NA
species$has.landscape[match(landscape$species, species$species)] <- "Yes"
species$has.landscape[which(is.na(species$has.landscape))] <- "No"
species <- merge(species, r2, by = "species", all = T)
species <- species[, c("species", "clade", "rsq", "assem.sz", "has.landscape")]
View(species)
species$species <- gsub("_", " ", species$species)
View(species)
colnames(species) <- c("Species", "Clade", "R2", "Assembly size", "Repeats analyzed")
write.csv(species, "table-s1.csv", row.names = F)
